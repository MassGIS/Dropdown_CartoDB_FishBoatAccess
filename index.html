<!DOCTYPE html>
<html>
<head>
    <script src="http://libs.cartocdn.com/cartodb.js/v3/cartodb.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0-rc1/js/bootstrap.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.css" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0-rc1/css/bootstrap.min.css" />
</head>
<body>
    <style>
        html, body{
        height: 100%;
        padding: 0;
        margin: 0;
        background-color: white;     
      } 
    #map {
        height: 1000px;
        border-top: 2px;
        border-bottom: 2px;
        border-right: 0px;
        border-left: 0px;
        border-style: solid;
        padding: 0px;
        border-color: #000000;
        background-color: #696969;
        
      }
        .form-group{
            width: 250px;
            padding-left: 25px;
            padding-bottom: 10px;
            padding-top: 10px;
            font-family: "Helvetica Neue",Helvetica,Arial,sans-serif !important;
            font-size: 14px !important;
            color: #333 !important;
            font-weight: bold !important;

        }
        #mapControl{
            display: block;
            border-top: 4px;
            border-bottom: 2px;
            border-right: 0px;
            border-left: 0px;
            border-style: solid;
            border-color: #000000;
        }
    </style>

    
    <div >
        <table id="mapControl">
                <tr>
                    <td class="form-group" style="font-size: 20px !important; width: 300px; text-align: center !important;">FISHING and BOATING ACCESS SITES</td>
                    <td class="form-group">
                        <label for="town">Town</label>
                        <select name="town" class="form-control">
                            <option value="">- All -</option>
                            <option value="AQUINNAH">Aquinnah</option>
                            <option value="ARLINGTON">Arlington</option>
                            <option value="ASHLAND">Ashland</option>
                            <option value="ATHOL">Athol</option>
                            <option value="ATTLEBORO">Attleboro</option>
                            <option value="AUBURN">Auburn</option>
                            <option value="BARNSTABLE">Barnstable</option>
                            <option value="BECKET">Becket</option>
                            <option value="BELCHERTOWN">Belchertown</option>
                            <option value="BERKLEY">Berkley</option>
                            <option value="BILLERICA">Billerica</option>
                            <option value="BOSTON">Boston</option>
                            <option value="BOURNE">Bourne</option>
                            <option value="BREWSTER">Brewster</option>
                            <option value="BRIDGEWATER">Bridgewater</option>
                            <option value="BRIGHTON">Brighton</option>
                            <option value="BROOKFIELD">Brookfield</option>
                            <option value="CANTON">Canton</option>
                            <option value="CHARLTON">Charlton</option>
                            <option value="CHELMSFORD">Chelmsford</option>
                            <option value="CHESHIRE">Cheshire</option>
                            <option value="CHICOPEE">Chicopee</option>
                            <option value="CHILMARK">Chilimark</option>
                            <option value="CLINTON">Clinton</option>
                            <option value="CONCORD">Concord</option>
                            <option value="DANVERS">Danvers</option>
                            <option value="DARTMOUTH">Dartmouth</option>
                            <option value="DEDHAM">Dedham</option>
                            <option value="DENNIS">Dennis</option>
                            <option value="DOUGLAS">Douglas</option>
                            <option value="DOVER">Dover</option>
                            <option value="DRACUT">Dracut</option>
                            <option value="EAST BRIDGEWATER">salem</option>
                            <option value="EASTHAM">Eastham</option>
                            <option value="EASTHAMPTON">Easthampton</option>
                            <option value="EDGARTOWN">Edgartown</option>
                            <option value="EGERMONT">Egermont</option>
                            <option value="ERVING">Erving</option>
                            <option value="FAIRHAVEN">Fairhaven</option>
                            <option value="FALL RIVER">Fall River</option>
                            <option value="FALMOUTH">Falmouth</option>
                            <option value="FRAMINGHAM">Framingham</option>
                            <option value="FREETOWN">Freetown</option>
                            <option value="GEORGETOWN">Georgetown</option>
                            <option value="GILL">Gill</option>
                            <option value="GLOUCESTER">Gloucester</option>
                            <option value="GOSHEN">Goshen</option>
                            <option value="GRAFTON">Grafton</option>
                            <option value="GREAT BARRINGTON">Great Barrington</option>
                            <option value="GROTON">Groton</option>
                            <option value="GROVELAND">Groveland</option>
                            <option value="HALIFAX">Halifax</option>
                            <option value="HAMILTON">Hamilton</option>
                            <option value="HANOVER">Hanover</option>
                            <option value="HANSON">Hanson</option>
                            <option value="HARDWICK">Hardwick</option>
                            <option value="HARWICH">Harwich</option>
                            <option value="HATFIELD">Hatfield</option>
                            <option value="HAVERHILL">Haverhill</option>
                            <option value="HINSDALE">Hinsdale</option>
                            <option value="HOLLAND">Holland</option>
                            <option value="HOPKINTON">Hopkinton</option>
                            <option value="HUBBARDSTON">Hubbardston</option>
                            <option value="HUDSON">Hudson</option>
                            <option value="IPSWICH">Ipswich</option>
                            <option value="LANCASTER">Lancaster</option>
                            <option value="LAWRENCE">Lawrence</option>
                            <option value="LEE">Lee</option>
                            <option value="LENOX">Lenox</option>
                            <option value="LEOMINSTER">Leominster</option>
                            <option value="LITTLETON">Littleton</option>
                            <option value="LOWELL">Lowell</option>
                            <option value="LUDLOW">Ludlow</option>
                            <option value="LYNN">Lynn</option>
                            <option value="MARBLEHEAD">Marblehead</option>
                            <option value="MARLBORO">Marlboro</option>
                            <option value="MARSHFIELD">Marshfield</option>
                            <option value="MASHPEE">Mashpee</option>
                            <option value="MATTAPOISETT">Mattapoisett</option>
                            <option value="MEDFORD">Medford</option>
                            <option value="MEDWAY">Medway</option>
                            <option value="MERRIMAC">Merrimac</option>
                            <option value="METHUEN">Methuen</option>
                            <option value="MIDDLEBOROUGH">Middleborough</option>
                            <option value="MILBURY">Milbury</option>
                            <option value="MILLIS">Millis</option>
                            <option value="MONTEREY">Monterey</option>
                            <option value="NANTUCKET">Nantucket</option>
                            <option value="NEEDHAM">Needham</option>
                            <option value="NEW BEDFORD">New Bedford</option>
                            <option value="NEWBURY">Newbury</option>
                            <option value="NEWBURYPORT">Newburyport</option>
                            <option value="NEW MARLBOROUGH">New Marlborough</option>
                            <option value="NEW SALEM">New Salem</option>
                            <option value="NORTH ADAMS">North Adams</option>
                            <option value="HOLLISTON">Holliston</option>
                            <option value="NORTH ATTLEBOROUGH">North Attleborough</option>
                            <option value="NORTHBOROUGH">Northborough</option>
                            <option value="NORTHBRIDGE">Northbridge</option>
                            <option value="NORTHFIELD">Northfield</option>
                            <option value="NORTH READING">North Reading</option>
                            <option value="NORTON">Norton</option>
                            <option value="OAK BLUFFS">Oak Bluffs</option>
                            <option value="ORANGE">Orange</option>
                            <option value="ORLEANS">Orleans</option>
                            <option value="OTIS">Otis</option>
                            <option value="PEPPERELL">Pepperell</option>
                            <option value="PITTSFIELD">Pittsfield</option>
                            <option value="PLYMOTH">Plymouth</option>
                            <option value="QUINCY">Quincy</option>
                            <option value="READING">Reading</option>
                            <option value="RICHMOND">Richmond</option>
                            <option value="ROCHESTER">Rochester</option>
                            <option value="RUTLAND">Rutland</option>
                            <option value="SALEM">Salem</option>
                            <option value="SALISBURY">Salisbury</option>
                            <option value="SANDSFIELD">Sandsfield</option>
                            <option value="SANDWICH">Sandwich</option>
                            <option value="SHREWSBURY">Shrewsbury</option>
                            <option value="SOMERSET">Somerset</option>
                            <option value="SOUTHWICK">Southwick</option>
                            <option value="SPENCER">Spencer</option>
                            <option value="SPRINGFIELD">Springfield</option>
                            <option value="STOCKBRIDGE">Stockbridge</option>
                            <option value="STOW">Stow</option>
                            <option value="STURBRIDGE">Sturbridge</option>
                            <option value="SUNDERLAND">Sunderland</option>
                            <option value="SUTTON">Sutton</option>
                            <option value="SWANSEA">Swansea</option>
                            <option value="TAUNTON">Taunton</option>
                            <option value="TISBURY">Tisbury</option>
                            <option value="TOLLAND">Tolland</option>
                            <option value="TOWNSEND">Townsend</option>
                            <option value="TRURO">Truro</option>
                            <option value="TYNGSBOROUGH">Tyngsborough</option>
                            <option value="TYRINGHAM">Tyringham</option>
                            <option value="WALTHAM">Waltham</option>
                            <option value="WARE">Ware</option>
                            <option value="WAREHAM">Wareham</option>
                            <option value="WAYLAND">Wayland</option>
                            <option value="WEBSTER">Webster</option>
                            <option value="WELLFLEET">Wellfleet</option>
                            <option value="WESTBOROUGH">Westborough</option>
                            <option value="WEST BRIDGEWATER">West Bridgewater</option>
                            <option value="WESTFIELD">Westfield</option>
                            <option value="WESTFORD">Westford</option>
                            <option value="WESTPORT">Wesport</option>
                            <option value="WEST STOCKBRIDGE">West Stockbridge</option>
                            <option value="WEST TISBURY">West Tisbury</option>
                            <option value="WEYMOUTH">Weymouth</option>
                            <option value="WILBRAHAM">Wilbraham</option>
                            <option value="WILLIAMSTOWN">Williamstown</option>
                            <option value="WILMINGTON">Wilmington</option>
                            <option value="WINCHENDON">Winchendon</option>
                            <option value="WINDSOR">Windsor</option>
                            <option value="WINTHROP">Winthrop</option>
                            <option value="WOBURN">Woburn</option>
                            <option value="WORCESTER">Worcester</option>
                            <option value="YARMOUTH">Yarmouth</option>
                        </select>
                    </td>
                    <td class="form-group">
                        <label for="fish_codes">Fish Species</label>
                        <select name="fish_codes" class="form-control">
                            <option value="All">- All -</option>
                            <option value="Trout">Trout</option>
                            <option value="Largemouth Bass">Largemouth Bass</option>
                            <option value="Smallmouth Bass">Smallmouth Bass</option>
                            <option value="Northern Pike">Northern Pike</option>
                            <option value="Tiger Muskee">Tiger Muskee</option>
                            <option value="White Perch">White Perch</option>
                            <option value="Pickerel">Pickerel</option>
                            <option value="Black Crappie">Black Crappie</option>
                            <option value="Walleye">Walleye</option>
                            <option value="Striped Bass">Striped Bass</option>
                            <option value="Bluefish">Bluefish</option>
                            <option value="Bonito">Bonito</option>
                            <option value="False Albacore">False Albacore</option>
                            <option value="Tautog">Tautog</option>
                            <option value="Fluke">Fluke</option>
                            <option value="Cod">Cod</option>
                            <option value="Flounder">Flounder</option>
                            <option value="Squetague - Weak Fish">Squetague - Weak Fish</option>
                        </select>
                    </td>
                    <td class="form-group">
                        <label for="facil_type">Facility Type</label>
                        <select name="facil_type" class="form-control">
                            <option value="">- All -</option>
                            <option value="General Access">General Access</option>
                            <option value="Fisherman Access">Fisherman Access</option>
                            <option value="Cartop Access">Cartop Access</option>
                            <option value="Canoe Access">Canoe Access</option>
                            <option value="Sport Fishing Pier">Sport Fishing Pier</option>
                            <option value="Sport Fishing Area">Sport Fishing Area</option>
                        </select>
                    </td>
                <tr>
            </table>
        <div id="map"></div>
    </div>


<script>
$('body').ready(function () {
    var myCustomLayer = undefined;

    var map = new L.Map('map', {
        zoomControl: false,
        center: [42.25, -71.81],
        zoom: 11
    });

    L.tileLayer('http://b.tile.stamen.com/toner-lite/{z}/{x}/{y}.png', {
        attribution: 'Stamen'
    }).addTo(map);



   // L.tileLayer('http://a.tile.stamen.com/terrain/{z}/{x}/{y}.png', {
      //  attribution: 'Stamen'
   // }).addTo(map);

   // L.tileLayer('https://cartocdn_{s}.global.ssl.fastly.net/base-eco/{z}/{x}/{y}.png', {
       // attribution: 'Mapbox <a href="http://mapbox.com/about/maps" target="_blank">Terms &amp; Feedback</a>'
  //  }).addTo(map);

    cartodb.createLayer(map, 'https://massgis.cartodb.com/u/massgis-admin/api/v2_1/viz/9916f4bc-1043-11e5-a5e4-0e4fddd5de28/viz.json')
        .addTo(map)
        .on('done', function (layer) {
        myCustomLayer = layer;
        //layer.setQuery('SELECT * FROM ofba_pt');
        layer.setInteraction(true);
    });

    $('#mapControl select').change(function () {
        redrawCartoLayer();
    });

    function redrawCartoLayer() {
        if (myCustomLayer !== undefined) {
            var baseQuery = 'SELECT * FROM ofba_pt WHERE (1 = 1)';
            var town = $('select[name="town"]').val();
            var fish_codes = $('select[name="fish_codes"]').val();
            var facil_type = $('select[name="facil_type"]').val();
            if (town != '') {
                baseQuery = baseQuery + " AND (town = '" + town + "')";
            }
            if (fish_codes != '') {
                var subQuery = '';
                switch (fish_codes) {
                    case "All":
                        subQuery = "fish_codes IS NOT NULL";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #FF9900; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill:#FFCC00; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 19;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 16;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 13;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 10;}");
                        break;
                    case "Trout":
                        subQuery = "fish_codes ILIKE '%1,%' or fish_codes ILIKE '%, 1%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #5a9497; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill:#81d4d9; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Largemouth Bass":
                        subQuery = "fish_codes ILIKE '%2,%' or fish_codes ILIKE '%, 2%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #cc6629; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill:#ff8034; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Smallmouth Bass":
                        subQuery = "fish_codes ILIKE '%3,%' or fish_codes ILIKE '%, 3%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #5c1377; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill:#b827ee; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Northern Pike":
                        subQuery = "fish_codes ILIKE '%4,%' or fish_codes ILIKE '%, 4%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #97b200; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill:#d8ff00; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Tiger Muskee":
                        subQuery = "fish_codes ILIKE '%5,%' or fish_codes ILIKE '%, 5%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #004184; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill:#006ddc; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "White Perch":
                        subQuery = "fish_codes ILIKE '%6,%' or fish_codes ILIKE '%, 6%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #008431; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill:#00dc53; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Pickerel":
                        subQuery = "fish_codes ILIKE '%7,%' or fish_codes ILIKE '%, 7%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #00427f; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #0084ff; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Black Crappie":
                        subQuery = "fish_codes ILIKE '%8,%' or fish_codes ILIKE '%, 8%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #a02900; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #e53b00; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Walleye":
                        subQuery = "fish_codes ILIKE '%9,%' or fish_codes ILIKE '%, 9%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #6f0012; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #9f001a; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Striped Bass":
                        subQuery = "fish_codes ILIKE '%10,%' or fish_codes ILIKE '%, 10%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #550052; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #d500cd; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Bluefish":
                        subQuery = "fish_codes ILIKE '%11,%' or fish_codes ILIKE '%, 11%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #789966; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #c9ffab; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Bonito":
                        subQuery = "fish_codes ILIKE '%12,%' or fish_codes ILIKE '%, 12%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #000000; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #fff; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "False Albacore":
                        subQuery = "fish_codes ILIKE '%13,%' or fish_codes ILIKE '%, 13%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #2f540c; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #4f8c14; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Tautog":
                        subQuery = "fish_codes ILIKE '%14,%' or fish_codes ILIKE '%, 14%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #35001b; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #6b0037; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Fluke":
                        subQuery = "fish_codes ILIKE '%15,%' or fish_codes ILIKE '%, 15%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #771353; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #ee27a6; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Cod":
                        subQuery = "fish_codes ILIKE '%16,%' or fish_codes ILIKE '%, 16%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #858E17; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #deee27; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Flounder":
                        subQuery = "fish_codes ILIKE '%17,%' or fish_codes ILIKE '%, 17%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #9c800c; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #e0b712; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                        break;
                    case "Squetague - Weak Fish":
                        subQuery = "fish_codes ILIKE '%18,%' or fish_codes ILIKE '%, 18%'";
                        myCustomLayer.setCartoCSS ("#ofba_pt{ marker-fill-opacity: 1; marker-line-color: #004b35; marker-line-width: 2; marker-line-opacity: 1; marker-allow-overlap: true; marker-fill: #007e59; marker-comp-op: multiply; marker-type: ellipse; marker-placement: point; marker-allow-overlap: true; marker-clip: false; marker-multi-policy: largest;}#ofba_pt [ sitemapsiz > 150 ] {marker-width: 17;}#ofba_pt [ sitemapsiz <= 150] {marker-width: 14;}#ofba_pt [ sitemapsiz <= 100] {marker-width: 11;}#ofba_pt [ sitemapsiz <= 75] {marker-width: 8;}#ofba_pt [ sitemapsiz <= 50] {marker-width: 5;}");
                }

                baseQuery = baseQuery + " AND (" + subQuery + ')';
            }
            if (facil_type != '') {
                var subQuery = '';
                switch (facil_type) {
                    case "General Access":
                        subQuery = "facil_type ILIKE '%A%' OR faciltype1 ILIKE '%A%' OR faciltype2 ILIKE '%A%' OR faciltype3 ILIKE '%A%'";
                        break;
                    case "Fisherman Access":
                        subQuery = "facil_type ILIKE '%B%' OR faciltype1 ILIKE '%B%' OR faciltype2 ILIKE '%B%' OR faciltype3 ILIKE '%B%'";
                        break;
                    case "Cartop Access":
                        subQuery = "facil_type ILIKE '%C%' OR faciltype1 ILIKE '%C%' OR faciltype2 ILIKE '%C%' OR faciltype3 ILIKE '%C%'";
                        break;
                    case "Canoe Access":
                        subQuery = "facil_type ILIKE '%D%' OR faciltype1 ILIKE '%D%' OR faciltype2 ILIKE '%D%' OR faciltype3 ILIKE '%D%'";
                        break;
                    case "Sport Fishing Pier":
                        subQuery = "facil_type ILIKE '%E%' OR faciltype1 ILIKE '%E%' OR faciltype2 ILIKE '%E%' OR faciltype3 ILIKE '%E%'";
                        break;
                    case "Sport Fishing Area":
                        subQuery = "facil_type ILIKE '%F%' OR faciltype1 ILIKE '%F%' OR faciltype2 ILIKE '%F%' OR faciltype3 ILIKE '%F%'";
                }

                baseQuery = baseQuery + " AND (" + subQuery + ')';
            }
            myCustomLayer.setQuery(baseQuery);
        }
    }
});
</script>
</body>
</html>